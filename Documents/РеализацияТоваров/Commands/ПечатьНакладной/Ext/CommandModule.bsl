#Область ОбработчикиСобытий

// Обработчик выполнения команды печати накладной с выбором варианта сортировки.
// Показывает диалог выбора порядка сортировки товаров в печатной форме.
//
// Параметры:
//  ПараметрКоманды - Массив из ДокументСсылка.РеализацияТоваров - документы для печати
//  ПараметрыВыполненияКоманды - Структура - параметры выполнения команды
//
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	СписокВыбора = Новый СписокЗначений;
	СписокВыбора.Добавить("ПоДлинеНаименования", "По длине наименования товара");
	СписокВыбора.Добавить("ПоНаименованию", "По наименованию товара");
	СписокВыбора.Добавить("ПоЦене", "По цене");
	
	ОписаниеОповещения = Новый ОписаниеОповещения("ПослеВыбораСортировки", ЭтотОбъект, ПараметрКоманды);
	СписокВыбора.ПоказатьВыборЭлемента(ОписаниеОповещения, "Выберите порядок сортировки:");
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Обработчик оповещения после выбора пользователем варианта сортировки.
// Формирует и выводит печатную форму накладной с выбранной сортировкой товаров.
//
// Параметры:
//  ВыбранныйЭлемент - ЭлементСпискаЗначений, Неопределено - выбранный вариант сортировки
//  ПараметрКоманды - Массив из ДокументСсылка.РеализацияТоваров - документы для печати
//
&НаКлиенте
Процедура ПослеВыбораСортировки(ВыбранныйЭлемент, ПараметрКоманды) Экспорт
	
	Если ВыбранныйЭлемент = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ВариантСортировки = ВыбранныйЭлемент.Значение;
	
	ТабДок = Новый ТабличныйДокумент;
	ПечатьНакладной(ТабДок, ПараметрКоманды, ВариантСортировки);
	
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.Защита = Ложь;
	ТабДок.ТолькоПросмотр = Ложь;
	ТабДок.ОтображатьЗаголовки = Ложь;
	
	ТабДок.Показать();
	
КонецПроцедуры

// Формирует печатную форму накладной с указанным вариантом сортировки.
//
// Параметры:
//  ТабДок - ТабличныйДокумент - табличный документ для вывода печатной формы
//  ПараметрКоманды - Массив из ДокументСсылка.РеализацияТоваров - документы для печати
//  ВариантСортировки - Строка - вариант сортировки товаров ("ПоДлинеНаименования", "ПоНаименованию", "ПоЦене")
//
&НаСервере
Процедура ПечатьНакладной(ТабДок, ПараметрКоманды, ВариантСортировки)
	
	Документы.РеализацияТоваров.ПечатьНакладной(ТабДок, ПараметрКоманды, ВариантСортировки);
	
КонецПроцедуры

#КонецОбласти
